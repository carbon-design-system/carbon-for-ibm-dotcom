/**
 * Copyright IBM Corp. 2016, 2023
 *
 * This source code is licensed under the Apache-2.0 license found in the
 * LICENSE file in the root directory of this source tree.
 */

@import 'carbon-components/scss/globals/scss/vendor/@carbon/elements/scss/themes/themes';
@import '../../globals/vars';
@import '../../globals/imports';

/// @access private
/// @group dotcom ui-shell Masthead L1

$search-transition: cubic-bezier(0.2, 0, 0.38, 0.9);
$search-transition-timing: 95ms;

@mixin mobile-button-sizing {
  border: none;
  border-bottom: 1px solid $ui-03;
  text-decoration: none;
  display: flex;
  justify-content: space-between;
  padding: $carbon--spacing-05;
  width: 100%;
  min-height: $spacing-07;
  gap: $carbon--spacing-06;

  &:focus-visible {
    outline: 2px solid $focus;
    outline-offset: -2px;
  }
}

@mixin desktop-button-sizing {
  appearance: none;
  background: transparent;
  border: none;
  text-decoration: none;
  display: inline-flex;
  white-space: nowrap;
  height: 100%;
  gap: $spacing-03;
  padding: $spacing-05;
}

@mixin masthead-l1 {
  .#{$prefix}--masthead__l1,
  :host(#{$dds-prefix}-masthead-l1) {
    @include carbon--theme($carbon--theme--white, true);

    display: flex;
    position: relative;
    max-width: 98rem;
    margin-left: auto;
    margin-right: auto;
    height: $layout-04;
    background-color: $ui-02;
    transition-timing-function: $search-transition;
    overflow: visible;
  }

  // L1 Mobile Styles
  @media screen and (max-width: 799px) {
    .#{$prefix}--masthead__l1-inner-container {
      width: 100%;
    }

    .#{$prefix}--masthead__l1-title {
      @include carbon--type-style(productive-heading-01);

      background-color: transparent;
      border: none;
      border-bottom: 3px solid $focus;
      color: $text-01;
      display: flex;
      justify-content: space-between;
      padding: $carbon--spacing-05;
      width: 100%;
      gap: $carbon--spacing-06;

      &:hover {
        background-color: $hover-ui;
      }

      &:active {
        background-color: $active-ui;
      }

      &:active,
      &:focus-visible {
        outline: 2px solid $focus;
        outline-offset: -2px;
      }

      &:disabled {
        color: $disabled-02;
        border-bottom-color: $disabled-02;
      }

      &.is-open {
        svg {
          transform: rotateX(180deg);
        }
      }

      svg {
        color: $icon-01;
      }
    }

    .#{$prefix}--masthead__l1-dropdown {
      // Height of viewport, minus the L0/L1 combo, minus additional space to match L0 megapanels
      max-height: calc(100vh - 98px - #{$layout-05} - #{$spacing-09});
      overflow-y: auto;
    }

    .#{$prefix}--masthead__l1-dropdown-item {
      @include carbon--type-style(body-short-01);
      @include mobile-button-sizing;

      background-color: transparent;
      color: $text-02;

      &:hover {
        background-color: $hover-ui;
        color: $text-01;
      }

      &:active {
        background-color: $active-ui;
        color: $text-01;
      }

      &:active,
      &:focus-visible {
        outline: 2px solid $focus;
        outline-offset: -2px;
      }

      &:disabled {
        color: $disabled-02;
        border-bottom-color: $disabled-02;
      }

      &.is-open {
        background-color: $selected-ui;
        color: $text-01;

        svg {
          transform: rotateX(180deg);
          color: $icon-01;
        }
      }

      svg {
        color: $icon-02;
      }
    }

    .#{$prefix}--masthead__l1-dropdown-subsection {
      padding-bottom: $carbon--spacing-07;
      border-bottom: 1px solid $ui-03;

      .#{$prefix}--masthead__l1-dropdown-item {
        padding-block: $carbon--spacing-04;
        padding-inline-start: $carbon--spacing-05;
        padding-inline-end: $carbon--spacing-08;
        border-bottom: none;
        color: $text-02;
      }
    }

    .#{$prefix}--masthead__l1-dropdown-announcement {
      @include carbon--type-style(body-short-01);

      margin: 0 $carbon--spacing-05 $carbon--spacing-05;
      padding: $carbon--spacing-05 0;
      border-bottom: 1px solid $ui-03;
    }

    .#{$prefix}--masthead__l1-dropdown-heading {
      @include carbon--type-style(productive-heading-01);

      color: $text-01;

      &:not(:has(> .#{$prefix}--masthead__l1-dropdown-item)) {
        padding-block: $carbon--spacing-04;
        padding-inline-start: $carbon--spacing-05;
        padding-inline-end: $carbon--spacing-08;
        width: 100%;
        min-height: $spacing-07;
      }

      .#{$prefix}--masthead__l1-dropdown-item {
        @include carbon--type-style(productive-heading-01);

        color: inherit;
        justify-content: flex-start;
        padding-block: $carbon--spacing-04;
        padding-inline-start: $carbon--spacing-05;
        padding-inline-end: $carbon--spacing-08;
        width: 100%;
        min-height: $spacing-07;
        gap: $carbon--spacing-03;
      }

      &:not(:nth-of-type(1)) {
        margin-top: $carbon--spacing-07;
      }
    }

    .#{$prefix}--masthead__l1-dropdown-viewall {
      @include carbon--type-style(body-short-01);

      background-color: transparent;
      text-decoration: none;
      display: flex;
      justify-content: flex-start;
      padding: $carbon--spacing-05;
      width: 100%;
      min-height: $spacing-07;
      gap: $carbon--spacing-03;

      &:hover {
        background-color: $hover-ui;
      }

      &:active {
        background-color: $active-ui;
      }

      &:active,
      &:focus-visible {
        outline: 2px solid $focus;
        outline-offset: -2px;
      }
    }

    .#{$prefix}--masthead__l1-dropdown-login {
      @include mobile-button-sizing;

      color: $interactive-01;

      svg {
        color: inherit;
      }

      &:hover {
        color: $hover-primary-text;
        background-color: $hover-ui;
      }

      &:focus-visible {
        color: $interactive-01;
      }

      &:active {
        color: $active-primary;
        background-color: $active-ui;
      }
    }

    .#{$prefix}--masthead__l1-dropdown-cta {
      @include mobile-button-sizing;

      background-color: $interactive-01;
      color: $ui-02;

      svg {
        color: inherit;
      }

      &:hover {
        background-color: $hover-primary;
      }

      &:focus-visible {
        outline-color: $ui-02;
        outline-offset: calc(-1 * #{$spacing-02});
      }

      &:active {
        color: $ui-02;
        background-color: $active-primary;
      }

      &:disabled {
        background-color: $disabled-02;
      }
    }
  }

  // L1 Desktop Styles
  @media screen and (min-width: 800px) {
    .#{$prefix}--masthead__l1-inner-container {
      width: 100%;
      height: $spacing-10;
      display: grid;
      grid-template-areas: 'padding platform menu spacer login cta';
      grid-template-columns: $spacing-05 auto minmax(1px, 1fr) $spacing-08 auto auto;
      border-bottom: 1px solid $ui-03;
      position: relative;
      z-index: 1;

      > * {
        position: relative;
        z-index: 1;
      }

      &::before,
      &::after {
        content: '';
        display: block;
        position: relative;
        z-index: 1;
        background-color: $ui-background;
      }

      &::before {
        grid-area: padding;
      }

      &::after {
        grid-area: spacer;
      }
    }

    .#{$prefix}--masthead__l1-title {
      @include carbon--type-style(productive-heading-01);
      @include desktop-button-sizing;

      grid-area: platform;
      height: 100%;
      color: $text-01;
      border-bottom: 3px solid transparent;
      padding-bottom: calc(#{$spacing-05} - 2px);
      align-items: flex-end;
      background-color: $ui-background;

      &:hover {
        background-color: $hover-ui;
      }

      &:active {
        background-color: $active-ui;
      }

      &:active,
      &:focus-visible {
        outline: 2px solid $focus;
        outline-offset: -2px;
      }
    }

    .#{$prefix}--masthead__l1-menu-container-outer {
      grid-area: menu;
      display: flex;
      z-index: 0;
    }

    .#{$prefix}--masthead__l1-menu-container-scroller {
      @include desktop-button-sizing;

      background-color: $ui-background;
      flex-shrink: 0;
      padding-inline: $spacing-03;
      align-items: flex-end;
      z-index: 1;

      &:hover {
        color: $text-01;
        background-color: $hover-ui;
      }

      &:active {
        color: $text-01;
        background-color: $active-ui;
      }

      &:active,
      &:focus-visible {
        outline: 2px solid $focus;
        outline-offset: -2px;
      }

      &[hidden] {
        /* stylelint-disable-next-line declaration-no-important */
        display: none !important;
      }
    }

    .#{$prefix}--masthead__l1-menu-container-inner {
      height: 100%;
      flex-shrink: 1;
      flex-grow: 1;
      z-index: 0;
    }

    .#{$prefix}--masthead__l1-menu {
      position: absolute;
      display: flex;
      height: 100%;
      transition: translate $search-transition-timing $search-transition;

      > li {
        position: relative;
      }
    }

    .#{$prefix}--masthead__l1-item {
      @include carbon--type-style(body-short-01);
      @include desktop-button-sizing;

      background-color: $ui-background;
      color: $text-02;
      border: 1px solid transparent;
      align-items: flex-end;

      &:hover {
        color: $text-01;
        background-color: $hover-ui;
      }

      &:active {
        color: $text-01;
        background-color: $active-ui;
      }

      &:active,
      &:focus-visible {
        outline: 2px solid $focus;
        outline-offset: -2px;
      }

      &:is([disabled], .is-disabled) {
        color: $disabled;
      }

      &.is-open {
        height: calc(100% + 3px);
        padding-bottom: calc(#{$spacing-05} + 3px);
        border-color: #c6c6c6;
        box-shadow: 0 0 6px #c6c6c6;
        clip-path: polygon(
          calc(0% - 6px) calc(0% - 6px),
          calc(100% + 6px) calc(0% - 6px),
          calc(100% + 6px) 100%,
          calc(0% - 6px) 100%
        );
      }

      svg {
        color: inherit;
      }
    }

    .#{$prefix}--masthead__l1-dropdown {
      position: absolute;
      inset-block-start: calc(100% + 1px);
      inset-inline-start: 0;
      width: 320px;
      background-color: $ui-background;
      border: 1px solid #c6c6c6;
      border-top: none;
      box-shadow: 0 0 6px #c6c6c6;
      clip-path: polygon(
        calc(0% - 6px) 0%,
        calc(100% + 6px) 0%,
        calc(100% + 6px) calc(100% + 6px),
        calc(0% - 6px) calc(100% + 6px)
      );
      padding: $spacing-05 0 $spacing-08;
      max-width: calc(100vw - (2 * #{$spacing-05}));
      visibility: hidden;

      &.is-open {
        visibility: visible;
      }

      &.#{$prefix}--masthead__l1-dropdown__1-col {
        width: 320px;
      }

      &.#{$prefix}--masthead__l1-dropdown__2-col {
        width: 640px;
      }

      &.#{$prefix}--masthead__l1-dropdown__3-col {
        width: 980px;
      }
    }

    .#{$prefix}--masthead__l1-dropdown-announcement {
      margin: 0 $spacing-05 $spacing-05;
      padding-bottom: $spacing-05;
      border-bottom: 1px solid $ui-03;
    }

    .#{$prefix}--masthead__l1-dropdown-menu-items {
      padding-bottom: $spacing-06;
    }

    .#{$prefix}--masthead__l1-dropdown-heading {
      @include carbon--type-style(productive-heading-03);

      color: $text-01;

      .#{$prefix}--masthead__l1-dropdown-item {
        @include carbon--type-style(productive-heading-03);
        @include desktop-button-sizing;

        align-items: center;
        padding: $spacing-03 $spacing-05;
        margin-bottom: $spacing-03;
      }

      &:not(:has(.#{$prefix}--masthead__l1-dropdown-item)) {
        padding: $spacing-03 $spacing-05;
        margin-bottom: $spacing-03;
      }
    }

    .#{$prefix}--masthead__l1-dropdown-item {
      @include carbon--type-style(body-short-01);
      @include desktop-button-sizing;

      align-items: center;
      padding: $spacing-03 $spacing-05;
      color: $text-02;
      width: 100%;

      &:hover {
        color: $text-01;
        background-color: $hover-ui;
      }

      &:active {
        color: $text-01;
        background-color: $active-ui;
      }

      &:active,
      &:focus-visible {
        outline: 2px solid $focus;
        outline-offset: -2px;
      }

      svg {
        color: inherit;
      }
    }

    .#{$prefix}--masthead__l1-cta {
      @include desktop-button-sizing;

      grid-area: cta;
      background-color: $interactive-01;
      color: $ui-02;
      align-items: flex-end;

      svg {
        color: inherit;
      }

      &:hover {
        background-color: $hover-primary;
      }

      &:focus-visible {
        outline-color: $ui-02;
        outline-offset: calc(-1 * #{$spacing-02});
      }

      &:active {
        color: $ui-02;
        background-color: $active-primary;
      }

      &:disabled {
        background-color: $disabled-02;
      }
    }

    .#{$prefix}--masthead__l1-login {
      @include desktop-button-sizing;

      grid-area: login;
      color: $interactive-01;
      background-color: $ui-background;
      align-items: flex-end;

      svg {
        color: inherit;
      }

      &:hover {
        color: $hover-primary-text;
        background-color: $hover-ui;
      }

      &:focus-visible {
        color: $interactive-01;
      }

      &:active {
        color: $active-primary;
        background-color: $active-ui;
      }
    }
  }
}

@include exports('masthead-l1') {
  @include masthead-l1;
}
