/**
 * Copyright IBM Corp. 2016, 2022
 *
 * This source code is licensed under the Apache-2.0 license found in the
 * LICENSE file in the root directory of this source tree.
 */

@use '@carbon/styles/scss/breakpoint' as *;
@use '@carbon/styles/scss/config' as *;
@use '@carbon/styles/scss/spacing' as *;
@use '@carbon/styles/scss/theme' as *;
@use '@carbon/styles/scss/type' as *;
@use '../../globals/vars' as *;
@use '../../globals/utils/flex-grid' as *;
@use '../../globals/utils/hang' as *;
@use '../card';
@use '../link-with-icon';

@mixin link-list {
  :host(#{$c4d-prefix}-link-list) {
    padding-bottom: 0;

    ul {
      padding: 0;
      margin: 0;
    }

    .#{$prefix}--link-list__list--card,
    .#{$prefix}--link-list__list--vertical,
    .#{$c4d-prefix}-ce--link-list__list--end {
      display: grid;
      grid-auto-rows: 1fr;

      ::slotted(#{$c4d-prefix}-link-list-item),
      ::slotted(#{$c4d-prefix}-link-list-item-cta) {
        outline: none;
      }
    }

    .#{$prefix}--link-list__list--vertical {
      grid-auto-rows: auto;
    }

    .#{$prefix}--link-list__list--card,
    .#{$c4d-prefix}-ce--link-list__list--end {
      ::slotted(#{$c4d-prefix}-link-list-item),
      ::slotted(#{$c4d-prefix}-link-list-item-cta) {
        display: grid;
      }
    }

    .#{$prefix}--link-list__list--vertical
      ::slotted(#{$c4d-prefix}-link-list-item) {
      display: flex;
    }

    .#{$c4d-prefix}-ce--link-list__list--end {
      ::slotted(#{$c4d-prefix}-link-list-item),
      ::slotted(#{$c4d-prefix}-link-list-item-cta) {
        border-top: 1px solid $border-subtle-01;
        border-bottom: 1px solid $border-subtle-01;
        margin-top: -1px;
        margin-left: -$spacing-05;
        --#{$c4d-prefix}--link-list-item--anchor-padding: #{$spacing-05};

        @include breakpoint(md) {
          margin-right: -$spacing-05;
        }
      }
    }

    .#{$c4d-prefix}-ce--link-list__heading__wrapper {
      display: contents;
    }

    @include breakpoint(md) {
      .#{$c4d-prefix}-ce--link-list__heading--split
        ::slotted(#{$c4d-prefix}-link-list-heading) {
        width: 33.3%;
        padding-right: 10%;
      }
    }

    .#{$c4d-prefix}-ce--link-list__list--split,
    .#{$c4d-prefix}-ce--link-list__list--three-columns {
      ::slotted(#{$c4d-prefix}-link-list-item) {
        display: grid;
        align-items: stretch;
        margin-right: -$spacing-05;
      }

      @include breakpoint(md) {
        display: grid;
        grid-column-gap: $spacing-07;

        ::slotted(#{$c4d-prefix}-link-list-item) {
          margin-left: -$spacing-05;
          margin-right: 0;
        }
      }
    }

    .#{$c4d-prefix}-ce--link-list__list--split {
      @include breakpoint(md) {
        grid-template-columns: 1fr 1fr;
      }
    }

    .#{$c4d-prefix}-ce--link-list__list--three-columns {
      @include breakpoint(md) {
        grid-template-columns: 1fr 1fr 1fr;
      }
    }
  }

  :host(#{$c4d-prefix}-link-list-item-card),
  :host(#{$c4d-prefix}-link-list-item-card-cta),
  .#{$prefix}--link-list {
    .#{$prefix}--card {
      max-width: none;

      &:not(:hover) {
        background: $background;
      }
    }

    .#{$prefix}--card__footer {
      margin-top: 0;

      svg {
        margin-right: 0;

        @include breakpoint-down(md) {
          align-self: start;
          margin-top: 1px; /* keeps icon centered when text is a single line */
        }
      }
    }

    .#{$prefix}--card__wrapper {
      // padding-left: $spacing-07;
      // padding-right: $spacing-07;

      .#{$prefix}--card__copy {
        margin-bottom: 0;

        @include breakpoint(lg) {
          margin-bottom: $spacing-07;
        }
      }

      // .#{$prefix}--card__copy p,
      .#{$prefix}--card__heading,
      .#{$prefix}--card__copy ::slotted(p) {
        color: $link-primary;
        @include type-style('body-compact-02');
      }

      @include breakpoint(md) {
        padding-left: 0;
        padding-right: 0;
      }

      &::before,
      &::after {
        display: none;
      }
    }

    .#{$prefix}--card__content {
      flex-direction: row;
      justify-content: space-between;

      @include breakpoint(lg) {
        flex-direction: column;
      }
    }

    &:focus {
      outline: none;
    }
  }

  :host(#{$c4d-prefix}-link-list-item-card-cta) {
    ::slotted(#{$c4d-prefix}-card-cta-footer) {
      @include breakpoint-down(lg) {
        margin-top: 0;
      }
    }
  }

  :host(#{$c4d-prefix}-link-list-item-card-cta)[cta-type='video'],
  .#{$prefix}--card__video {
    [slot='heading'],
    .#{$prefix}--card__heading {
      margin-bottom: 0;

      @include type-style('body-compact-02');

      @include breakpoint(lg) {
        margin-bottom: $spacing-05;
      }
    }
  }

  :host(#{$c4d-prefix}-link-list-item-card-cta)[cta-type='video'] {
    [slot='heading'],
    .#{$prefix}--card__heading {
      color: $link-primary;
    }
  }

  :host(#{$c4d-prefix}-link-list-heading) {
    margin-bottom: $spacing-05;
    color: $text-primary;
    display: block;

    .#{$prefix}--link {
      cursor: pointer;
    }

    @include type-style('heading-02');
  }

  :host(#{$c4d-prefix}-link-list-item) {
    &:focus {
      outline: none;
    }
  }

  :host(#{$c4d-prefix}-link-list-item-card) .#{$prefix}--link:focus {
    outline: $spacing-01 solid $focus;
    outline-offset: -#{$spacing-01};
  }

  .#{$prefix}--link-list__list.#{$prefix}--link-list__list--card {
    margin-left: -$spacing-05;
    margin-right: -$spacing-05;
  }

  :host(#{$c4d-prefix}-link-list-item-card) .#{$prefix}--link:focus {
    outline: $spacing-01 solid $focus;
    outline-offset: -#{$spacing-01};
  }

  :host(#{$c4d-prefix}-link-list-item)
    .cds--link-with-icon__icon-left
    ::slotted(svg[slot='icon']),
  :host(#{$c4d-prefix}-link-list-item-cta)
    .cds--link-with-icon__icon-left
    ::slotted(svg[slot='icon']) {
    min-width: 20px;
    min-height: 20px;
  }

  :host(#{$c4d-prefix}-link-list-item)[type='end'],
  :host(#{$c4d-prefix}-link-list-item-cta)[type='end'] {
    outline: none;

    &:hover {
      .#{$prefix}--link {
        text-decoration: none;
        background: $background-hover;
      }
    }

    .#{$prefix}--link {
      // TODO: See if there is a better solution than an internal custom property
      padding: var(--#{$c4d-prefix}--link-list-item--anchor-padding, 0);
      display: flex;
    }
  }

  :host(#{$c4d-prefix}-link-list):last-of-type {
    padding-bottom: $spacing-10;
  }

  .#{$prefix}--link-list__list--horizontal {
    ::slotted(#{$c4d-prefix}-link-list-item),
    ::slotted(#{$c4d-prefix}-link-list-item-card),
    ::slotted(#{$c4d-prefix}-link-list-item-cta),
    ::slotted(#{$c4d-prefix}-link-list-item-card-cta),
    .#{$prefix}--link-list__list__CTA {
      float: left;
      padding-right: $spacing-07;
      padding-bottom: $spacing-05;

      @include breakpoint(md) {
        padding-bottom: 0;
      }
    }
  }

  .#{$prefix}--link-list__list--vertical {
    .#{$prefix}--link-list__list__CTA {
      margin-bottom: $spacing-05;

      &:last-of-type {
        margin-bottom: 0;
      }
    }

    ::slotted(*) {
      margin-bottom: $spacing-05;
    }

    ::slotted(*:last-of-type) {
      margin-bottom: 0;
    }
  }

  .#{$prefix}--content-item-horizontal__item--cta {
    .#{$prefix}--link-list li {
      &:last-of-type {
        @include breakpoint(lg) {
          margin-bottom: 0;
        }
      }
    }
  }

  .#{$prefix}--link-list__list--vertical-end {
    ::slotted(#{$c4d-prefix}-link-list-item),
    ::slotted(#{$c4d-prefix}-link-list-item-cta),
    .#{$prefix}--link-list__list__CTA .#{$prefix}--link-with-icon__container {
      @include make-col-ready;

      width: 100%;
    }

    .#{$prefix}--link-list__list__CTA .#{$prefix}--link-with-icon__container {
      a {
        padding: $spacing-05 0;
        justify-content: space-between;

        &:hover {
          text-decoration: none;
        }

        &:focus {
          outline: none;
        }
      }

      svg {
        align-self: start;
        margin-left: $spacing-07;
        margin-top: 1px; /* keeps icon centered when text is a single line */
      }
    }
  }

  .#{$prefix}--link-list__list--vertical-end .#{$prefix}--link-list__list__CTA {
    border-bottom: 1px solid $layer-accent-01;
    max-width: 640px;
    @include hang;

    &:hover {
      background: $background-hover;
    }

    &:focus-within {
      outline: $spacing-01 solid $focus;
    }

    &:first-of-type {
      border-top: 1px solid $layer-accent-01;
    }
  }

  :host(#{$c4d-prefix}-link-list-item-card),
  :host(#{$c4d-prefix}-link-list-item-card-cta),
  .#{$prefix}--link-list__list__CTA {
    &.#{$prefix}--link-list__list--video .#{$prefix}--card__footer span {
      color: $link-primary;
      display: none;

      @include breakpoint(lg) {
        display: inline;
      }
    }
  }

  :host(#{$c4d-prefix}-link-list-item-card),
  :host(#{$c4d-prefix}-link-list-item-card-cta),
  .#{$prefix}--link-list__list--card .#{$prefix}--link-list__list__CTA {
    max-width: carbon--mini-units(80);
    border-top: 1px solid $layer-accent-01;

    &:last-of-type {
      border-bottom: 1px solid $layer-accent-01;
    }
  }

  :host(#{$c4d-prefix}-link-list-item-card),
  :host(#{$c4d-prefix}-link-list-item-card-cta),
  .#{$prefix}--link-list__list--card .#{$prefix}--link-list__list__CTA div {
    .#{$prefix}--tile {
      margin-left: 0;
      margin-right: 0;
      min-height: 0;

      .#{$prefix}--card__wrapper {
        min-height: 0;
        padding: 0;

        @include breakpoint(lg) {
          min-height: 116px;
        }
      }
    }
  }
}
