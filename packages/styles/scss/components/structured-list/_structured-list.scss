//
// Copyright IBM Corp. 2019, 2021
//
// This source code is licensed under the Apache-2.0 license found in the
// LICENSE file in the root directory of this source tree.
//

@import '../../globals/imports';
@import '../../globals/vars';
@import 'carbon-web-components/scss/components/structured-list/structured-list';

// Overridden column spanning
@mixin structured-list-colspan($colNumber) {
  &:nth-child(#{$colNumber}) {
    --cols: var(--col-span-#{$colNumber}, 2);
    --width: calc((var(--cols) / var(--max-cols)) * 100%);

    max-width: var(--width);
    flex: 0 0 var(--width);
  }

  @include carbon--breakpoint('md') {
    &:nth-child(#{$colNumber}) {
      --cols: var(
        --col-span-md-#{$colNumber},
        var(--col-span-#{$colNumber}, 2)
      );
      --width: calc((var(--cols) / var(--max-cols)) * 100%);

      max-width: var(--width);
      flex: 0 0 var(--width);
    }
  }

  @include carbon--breakpoint('lg') {
    &:nth-child(#{$colNumber}) {
      --cols: var(
        --col-span-lg-#{$colNumber},
        var(--col-span-md-#{$colNumber}, var(--col-span-#{$colNumber}, 2))
      );
      --width: calc((var(--cols) / var(--max-cols)) * 100%);

      max-width: var(--width);
      flex: 0 0 var(--width);
    }
  }
}

@mixin structured-list {
  // Inherited Table Styles
  :host(#{$dds-prefix}-structured-list-header-row) {
    border-bottom: none;
  }
  :host(#{$dds-prefix}-structured-list-header-cell) {
    @extend .#{$prefix}--structured-list-th;

    padding-inline: $spacing-05;
    padding-block-end: $spacing-05;
    border-bottom: 1px solid $ui-03;
  }
  :host(#{$dds-prefix}-structured-list-group) {
    display: contents;

    tr {
      @extend .#{$prefix}--structured-list-row;

      background-color: $ui-03;
      box-shadow: 100vw 0 $ui-03, 200vw 0 $ui-03, 300vw 0 $ui-03, 400vw 0 $ui-03,
        500vw 0 $ui-03, 600vw 0 $ui-03, 700vw 0 $ui-03, 800vw 0 $ui-03,
        900vw 0 $ui-03;
      color: $text-01;
      border-bottom: 1px solid $ui-03;
    }

    th {
      @extend .#{$prefix}--structured-list-td;

      color: $text-01;
      text-align: left;
      font-weight: bold;
      padding-inline: $spacing-05;
    }
  }
  :host(#{$dds-prefix}-structured-list-cell) {
    @extend .#{$prefix}--structured-list-td;

    padding-inline: $spacing-05;
    border-bottom: 1px solid $ui-03;
  }

  // Default Carbon Rows/Columns
  :host(#{$dds-prefix}-structured-list-header-row),
  :host(#{$dds-prefix}-structured-list-row),
  :host(#{$dds-prefix}-structured-list-group) tr {
    @include carbon--breakpoint('sm') {
      @include carbon--make-row();

      flex-wrap: nowrap;
    }
  }

  :host(#{$dds-prefix}-structured-list-header-cell),
  :host(#{$dds-prefix}-structured-list-cell),
  :host(#{$dds-prefix}-structured-list-group) td {
    height: auto;

    @include carbon--breakpoint('sm') {
      @include carbon--make-col(2, 4);
    }

    @include carbon--breakpoint('md') {
      @include carbon--make-col(2, 8);
    }

    @include carbon--breakpoint('lg') {
      @include carbon--make-col(2, 16);
    }
  }

  :host(#{$dds-prefix}-structured-list-header-cell),
  :host(#{$dds-prefix}-structured-list-cell) {
    --max-cols: 4;

    @include carbon--breakpoint('md') {
      --max-cols: 8;
    }

    @include carbon--breakpoint('lg') {
      --max-cols: 16;
    }

    @include structured-list-colspan(1);
    @include structured-list-colspan(2);
    @include structured-list-colspan(3);
    @include structured-list-colspan(4);
    @include structured-list-colspan(5);
    @include structured-list-colspan(6);
    @include structured-list-colspan(7);
    @include structured-list-colspan(8);

    &:last-child {
      flex-grow: 1;
      max-width: none;
    }
  }

  // Internal components
  :host(#{$dds-prefix}-structured-list-cell) #{$prefix}-tooltip-icon {
    display: inline-flex;
    vertical-align: sub;

    svg {
      fill: $icon-02;
    }
  }

  :host(#{$dds-prefix}-structured-list-cell[icon]) {
    &[icon='checkmark'] {
      color: $support-02;
    }
  }
}

@include exports('structured-list') {
  @include structured-list;
}
