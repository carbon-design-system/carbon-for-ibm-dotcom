/**
 * Copyright IBM Corp. 2016, 2021
 *
 * This source code is licensed under the Apache-2.0 license found in the
 * LICENSE file in the root directory of this source tree.
 */

@use '@carbon/styles/scss/breakpoint' as *;
@use '@carbon/styles/scss/config' as *;
@use '@carbon/styles/scss/motion' as *;
@use '@carbon/styles/scss/spacing' as *;
@use '@carbon/styles/scss/theme' as *;
@use '@carbon/styles/scss/themes' as *;
@use '@carbon/styles/scss/type' as *;
@use '../../globals/vars' as *;
@use '../card';
@use '@carbon/styles/scss/components/search' as *;
@use '@carbon/styles/scss/components/modal' as *;

/// Locale modal
/// @access private
/// @group locale-modal

@mixin locale-modal {
  :host(#{$cds-prefix}-locale-modal),
  .#{$prefix}--locale-modal-container {
    @include theme(
      $white,
      feature-flag-enabled('enable-css-custom-properties')
    );

    .#{$prefix}--modal-container {
      background-color: $background;
      height: 100%;
      min-height: 80%;

      @media (max-height: rem(450px)) {
        .#{$prefix}--locale-modal__filtering {
          .#{$prefix}--locale-modal__filter {
            overflow-y: initial;

            .#{$prefix}--locale-modal__list {
              overflow-y: initial;
            }
          }
        }

        .#{$prefix}--locale-modal__search {
          position: relative;
        }
      }
    }

    .#{$prefix}--locale-modal {
      padding-left: $spacing-05;
      margin-bottom: $spacing-05;
      margin-top: $spacing-07;
      display: flex;

      &.#{$prefix}--modal-content {
        padding-right: $spacing-05;
      }

      @include type-style(body-compact-02, true);
    }

    .#{$prefix}--locale-modal__locales.#{$prefix}--locale-modal__locales-hidden {
      display: none;
    }

    button.#{$prefix}--modal-header__label,
    .#{$prefix}--locale-modal__back .#{$prefix}--modal-header__label {
      padding: 0;
      border: none;
      background-color: transparent;
      display: inline-flex;

      &:hover {
        cursor: pointer;
        color: $background-brand;
        text-decoration: underline;
      }

      &:focus {
        outline-width: $spacing-01;
        outline-offset: -#{$spacing-01};
        outline-color: $background-brand;
      }

      svg {
        fill: currentColor;
      }
    }

    .#{$prefix}--locale-modal__filter {
      z-index: -1;
      opacity: 0;
      transform: translate3d(0, -24px, 0);
      transition: transform 240ms cubic-bezier(0.4, 0.14, 1, 1);
      display: none;
      top: $spacing-09;
    }

    .#{$prefix}--modal-header {
      padding-left: $spacing-07;
      padding-top: $spacing-05;
    }

    .#{$prefix}--modal-header__label {
      color: $text-primary;
      display: flex;
      align-items: center;

      .#{$prefix}--locale-modal__label-globe {
        width: rem(20px);
        height: rem(20px);
        margin-left: $spacing-02;
      }

      .#{$prefix}--locale-modal__label-arrow {
        margin-right: $spacing-03;
      }

      @include type-style('body-compact-02');
    }

    .#{$prefix}--modal-header__heading {
      @include type-style('fluid-heading-04', true);

      margin-top: $spacing-04;

      &:focus {
        outline: none;
      }
    }

    // FIXME: CardLink is being used as Card in React, need to separate this
    .#{$prefix}--card__CTA.#{$prefix}--card-link .#{$prefix}--card__heading {
      @include type-style('fluid-heading-03', true);
    }
  }
}

:host(#{$prefix}-search) .#{$prefix}--search-input,
.#{$prefix}--search--xl .#{$prefix}--search-input {
  &::placeholder {
    color: $text-secondary;
  }
}

.#{$prefix}--locale-modal-container .#{$prefix}--locale-modal__regions {
  width: 100%;
  margin-top: auto;
  > .#{$prefix}--row {
    margin-left: 0;
    margin-right: 0;
  }
}

:host(#{$cds-prefix}-region-item) .#{$prefix}--link,
.#{$prefix}--locale-modal-container
  .#{$prefix}--locale-modal__regions
  .#{$prefix}--card {
  min-height: rem(184px);
  outline: 1px solid $layer-02;
  outline-offset: -1px;
  max-width: none;
  width: 100%;
  height: 100%;
  display: flex;

  &:focus-within {
    outline-width: $spacing-01;
    outline-offset: -#{$spacing-01};
    outline-color: $background-brand;
  }

  @include breakpoint-down(lg) {
    min-height: $spacing-12;
  }
}

:host(#{$cds-prefix}-region-item),
.#{$prefix}--modal-container {
  svg.#{$prefix}--card__cta {
    color: $border-inverse;
  }
}

:host(#{$cds-prefix}-locale-item) a.#{$prefix}--link,
.#{$prefix}--locale-modal-container .#{$prefix}--locale-modal__locales {
  text-decoration: none;
  border: $spacing-01 solid transparent;
  display: flex;
  min-height: $spacing-09;
  border-bottom: 1px solid $layer-accent-01;
  transition: background-color $duration-fast-02 motion(standard, expressive),
    border $duration-fast-02 motion(standard, expressive);

  &:hover {
    background-color: $background-hover;
  }

  &:active,
  &:focus {
    border: $spacing-01 solid $focus;
    outline: none;
  }
}

:host(#{$cds-prefix}-locale-item),
.#{$prefix}--locale-modal-container {
  .#{$prefix}--locale-modal__locales__name {
    width: 50%;
    color: $text-helper;
    padding: $spacing-04 $spacing-05;
    @include type-style('body-compact-02');

    &:first-of-type {
      color: $text-primary;
    }
  }
}

:host(#{$cds-prefix}-locale-search),
.#{$prefix}--locale-modal-container .#{$prefix}--locale-modal__filtering {
  display: flex;
  flex-direction: column;
  margin-top: $spacing-07;
  overflow: hidden;

  .#{$prefix}--locale-modal__filter {
    opacity: 1;
    z-index: 1;
    transform: translate3d(0, 0, 0);
    transition: 240ms cubic-bezier(0, 0, 0.3, 1);
    display: flex;
    flex-direction: column;
    flex: 1;
    overflow: hidden;
  }

  .#{$prefix}--locale-modal__regions {
    visibility: hidden;
    z-index: -1;
    opacity: 0;
    display: none;
    transition: 240ms cubic-bezier(0, 0, 0.3, 1);
  }
}

:host(#{$cds-prefix}-locale-search),
.#{$prefix}--locale-modal-container {
  .#{$prefix}--locale-modal__search {
    position: sticky;
    top: 0;
    background-color: $background;
    border-bottom: rem(1px) solid $layer-accent-01;

    .#{$prefix}--search-input {
      background-color: $field-01;
    }
  }

  .#{$prefix}--locale-modal__search-text {
    padding: $spacing-07 $spacing-05 $spacing-05;
    min-height: $spacing-09;

    @include type-style('label-02');
  }

  .#{$prefix}--locale-modal__list {
    flex: 1;
    overflow-y: auto;
  }
}
